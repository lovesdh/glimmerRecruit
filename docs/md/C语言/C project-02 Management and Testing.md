<img src="https://pic.imgdb.cn/item/64fdc2b6661c6c8e543d9600.png" alt="C.png">

# C project-02 Management and Testing

> 难度系数：中等
>
> 首先，恭喜你👋👋👋，你已经踏出做项目的第一步了，接下来，请继续为这个计算器添加一些功能。
>
> 作为一个计算器🧮🧮🧮，最重要的功能就是计算，另外很重要的一部分就是组织和管理这个项目，接下来，你将完成计算器部分计算功能，学习如何组织和管理这个项目，同时，为了判断计算器的正确性，你将要学习如何测试你的计算器。💪💪💪

## **Part 0 计算**

在C-project01，你已经完成了中缀表达式转后缀表达式，现在，就利用后缀表达式计算出结果。

### **任务**

- 将输入的表达式转为后缀表达式后，计算表达式结果
- 计算支持`+ - * /  ()`,支持整数和浮点数
- 简单描述一下你的实现思路

### **提示**

- 运用栈，结构体
- 了解一下`atoi()`函数，`atof()`函数
- 注意识别错误表达式，以及0作为分母
- 注意忽略表达式中的空格，可以了解一下`strtok()`函数

## **Part 1 交互⌨️⌨️⌨️**

现在，你的计算器只能计算一条表达式，然后程序就结束了，如果想要计算多条表达式，那么只能反复运行程序，太繁琐了，现在，来升级一下你的计算器，让他可以计算多条表达式，同时，让你的计算器成为一个可以通过命令行交互的计算器（像shell，python一样）。😊😊😊

### **任务**

- 为你的计算器提供命令行交互，你的计算器一直运行着，除非输入`quit`（程序崩溃或`ctrl+c`终止进程例外），每条表达式以键入`enter`结束，计算器计算结果，输出，接着等待下一个操作。
  - ```Plain
    linux> ./cproject
    interaction> 2+4
    result> 6
    interaction> 2+4*8
    result> 34
    interaction> quit
    linux>
    ```
- 为你的计算器提供`help`命令，当输入`help`时，打印计算器的操作帮助信息。
- 你的计算器要支持一键删除，例如，当输入表达式时，觉得表达式错了，可以键入`ctrl+u`清除当前行
- 你的计算器要支持保留历史记录，像shell一样，通过`↑,↓`,可以查看历史命令(表达式)
- 你的计算器可以接受命令行参数`-t <file>`,`-t`表示你的计算器为后续测试作准备，计算器把每条表达式的结果输入到以`-t`参数为名字的文件中。
  - ```Plain
    linux> ./cproject -t result.txt
    ```

  -  result.txt内容格式

  - ```Plain
    243
    456
    456
    6
    7
    23
    ```
- 尝试改变一下提示字符串的颜色

### **提示**

- 了解`readline`库，尝试使用`readline`库
- 小心内存泄漏
- 了解一下什么是命令行选项，什么是命令行参数
- 了解一下`getopt`函数

## **Part 2 使用Makefile**

作为一个项目，把全部代码放在一个文件中，太臃肿了，引入多文件，将项目划分成多个模块，但是，项目编译时，需要输入很多命令，同时，假如一个文件的一个小地方修改了，又要寻找与这个修改文件相关联的其他文件，重新编译链接，十分麻烦，怎么样高效率构建项目呢，尝试使用`makefile`.

### **任务**

- `makefile`在编译整个项目中充当什么角色，有什么用，谈谈你的理解🤔🤔🤔
- 将计算器划分为多个文件，并利用`makefile`编译

### **提示**

- [make命令教程](https://www.ruanyifeng.com/blog/2015/02/make.html)
- [跟我一起写makefile](https://seisman.github.io/how-to-write-makefile/overview.html)
- [GUN make](https://www.gnu.org/software/make/manual/make.html)

## **Part 3 使用git**

每次在计算器上添加功能，都要修改代码，假如不小心修改的时候，整个项目被修改得面目全非，也跑不起来，而你想回到修改前的样子，怎么办呢，使用`git`管理你的项目。

### **任务**

- 简单描述一下，工作区，暂存区，仓库区是什么
- 创建`git`仓库，完成一次提交，把项目代码提交到本地仓库上
- 使用`github`,注册`github`账号，创建`github`仓库，把项目代码放在`github`仓库上
- 创建一个分支，`part4`的测试功能在该分支下完成，完成后，合并到主分支上

### **提示**

- [Git 教程 | 菜鸟教程 (runoob.com)](https://www.runoob.com/git/git-tutorial.html)
- [日常-06：代码管理 | 微光招新 (glimmer.org.cn)](https://recruit.glimmer.org.cn/md/日常基础/日常-06：代码管理.html)
- [学习git小游戏](https://learngitbranching.js.org/?locale=zh_CN)
- 注意合并冲突

## **part 4 测试**

如何检测计算器的正确性呢，可以通过测试检测计算器的正确性，在这部分，尝试一下对你的计算器进行测试吧。(加油，最后一部分了🫡🫡🫡)

### **任务**

- 了解软件测试
- 了解差分测试，使用差分测试检测你的计算器的正确性
- 使用我们给予的测试用例，使用差分测试检测计算器的正确性
- 测试用例，遇到错误的表达式，计算器应该识别出来，并输出提示用户，表达式有误
  - ```Plain
    2*3-1 + 2
    1   +  4 -2* 2
    ( 2  +3)/  5
    (2147483647-2147483646)*(12345678-12345670)
    (3+4)/(5-5)
    ()*5*6*7
    1+a+3*4+1890/7895
    (987.5 -568.27)*((998-997)+(2/(2*1))-1)
    ((8+2)*3)-(4/2)+7
    ((3+2)*4)-((6-1)/2)
    -((8+2)*3)-(4/2)+7
    -8*2-3+2-2*(-8)
    ((10-4)*(3+2)/(7-1))
    (67.5555-67.4444)*(478.9847-476.9847)
    ```

### 提示

- 可以尝试编写测试代码来进行测试(仅供参考）
  - ```C
    int main()
    {
        int ret = system("make");
        assert(ret != -1);
        ret = system("./interaction -t result.txt < test.txt");
        assert(ret != -1);
        system("diff -y -w test.txt answer.txt");
        return 0;
    }
    ```
- 了解一下`diff`工具
- 了解一下`system`函数，`assert`函数，`popen`函数
- 了解一下`shell`输入，输出重定向

## **需要提交的内容及要求**

- 可以描述一下解题过程中遇到的困难以及如何解决的，描述一下解题思路
- 存放项目的`github`仓库链接，仓库上的内容应该是添加完交互功能和使用`makefile`的项目内容
- 添加交互功能后，计算器运行截图
- 使用命令行参数后，计算器运行截图
- `makefile`运行结果截图
- 使用`git`时相应截图，例如，提交，创建分支，转换分支，合并等等
- 测试用例运行结果截图
- 用自己的想法回答题目问题
- 良好的代码习惯（加分🥰）
- 请提交PDF文档

## **本题提交方式**

> 收件邮箱：[glimmer401@outlook.com](mailto:glimmer401@outlook.com)
>
> 主题格式： 学号-姓名-考核-Cproject-02
>
> 主题示例：2023090101012-张三-考核-Cproject-02

## **出题人联系方式**

> QQ:239148349
>
> 邮箱：[LLP_PLL@outlook.com](mailto:LLP_PLL@outlook.com)
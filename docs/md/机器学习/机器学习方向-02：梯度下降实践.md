![](https://img1.imgtp.com/2024/09/10/081jz2kT.PNG)

# 机器学习方向-02：梯度下降理论和实践

> `难度系数`：简单
>
> 在之前的微积分课程里，你应该学过了导数。那偏导数是什么？它在机器学习里扮演了怎样的角色？不妨来试试吧！高中的时候都学过用最小二乘法求直线方程，你知道它是怎么来的吗？不用怕，这里不用你推导它。根据采样点求直线可以直接套公式就好了，可惜更多时候这个公式**复杂得超乎想象甚至根本不存在**。那么使用损失函数和偏导数的方法能做到什么呢?上吧，梯度下降法！
>
> **温馨提示：微积分很重要！😊**


## 题目要求

- 生成数据集，随机生成常数 $a,b,c$

  生成 500 条数据，满足以下条件：  

  $$\begin{cases}F(x,y)=ax^3+be^y+c+e\\x\sim U(-2, 2)\\y\sim U(-2, 2)\\e\sim N(0, 0.01)\end{cases}$$ 

  其中，$x\sim U(-2,2)$ 表示随机变量 x 服从 -2 到 2 的均匀分布，e 为人为构造的噪声，$e\sim N(0,0.01)$ 表示随机变量 e 服从均值为 0，方差为 0.01 的正态分布。

- 应用**梯度下降法**，求出恰当的 $\hat{a}, \hat{b}, \hat{c}$ ，使每个数据点到平面 $\hat{F}(x,y)=\hat{a}x^3+\hat{b}e^y+\hat{c}$ 的**竖直方向距离（Z轴方向）的平方之和**最小。 训练过程中，要求每 20 次迭代打印当前损失（点到平面的竖直距离）。

- 将上述任务代入到机器学习中，$F(x, y)$ 即标签 label，而 $\hat{F}(x, y)$ 即每次的预测值，损失采用 MSE 损失

- 如果你正确的使用了梯度下降法，那么求得的 $\hat{a},\hat{b},\hat{c}$ 将与你预先设定的 $a,b,c$ 非常接近。

- 把你的 $x\sim U(-2, 2),y\sim U(-2, 2)$ 修改为 $x\sim U(3, 7), y\sim U(3, 7)$ 之后，还能得到预期结果吗？如果不能，思考原因并给出解决方案。（提示：和梯度有关）

## 回答要求

1. 梯度和偏导的关系；
2. 梯度下降法实现拟合函数的过程（简单推导）；
3. 生成数据的代码 和 拟合数据的代码；
4. 代码运行结果截图；
5. 必要的注释说明及良好的代码规范；
6. 实现思路和学到的知识点。

## 需要掌握的知识点

1. 梯度下降法的原理
2. 基础的 Python 语法（***库函数只能使用 Numpy，不能使用 tf , sklearn ,*** ***pytorch*** ***等***）
3. 损失函数的作用

## 思考题

1. 在这道题中，我们必须设定一个**学习率**才能进行正常的训练。结合数学公式谈谈学习率的作用，并且动手调试你的代码，看看学习率过大或者过小时会发生什么事情

2. 我们在这道题中使用梯度下降法拟合了一个简单函数。在训练之前，我们已经知道了 $a,b,c$的值，所以能对你得出的结果进行直观的检验。但在实际应用中，$a,b,c$ 通常是未知数。**如果我们不知道一个函数的参数（在这道题中是** $F(x,y)=ax^3+be^y+c+e$ **中的** $a,b,c$ **)，我们也需要检验所得结果的准确性。想想应该怎么做？**

   

## 本题提交方式

> 收件邮箱：glimmer401@outlook.com  
>
>主题格式：学号-姓名-考核-机器学习-02
>
>主题示例：2020091202014-张三-考核-机器学习-02


## 出题者联系方式

> QQ：1191732972
>
> 邮箱：1191732972@qq.com
